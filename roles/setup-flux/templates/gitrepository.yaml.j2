apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: podinfo
  namespace: flux-system
spec:
  interval: 10m
  url: ssh://git@{{ git_repository }}
  ref:
    branch: main
  secretRef:
    name: ssh-credentials
---
apiVersion: v1
kind: Secret
metadata:
  name: ssh-credentials
  namespace: flux-system
type: Opaque
data:
  identity: {{ ssh_identity | b64encode }}
  identity.pub: {{ ssh_identity_pub | b64encode }}
  known_hosts: {{ ssh_known_hosts | b64encode }}
